<script>
    const placedImages = []; // store previous image positions

    function getElementRect(element) {
        const rect = element.getBoundingClientRect();
        return {
            x: rect.left + rect.width/2,
            y: rect.top + rect.height/2,
            size: Math.max(rect.width, rect.height)
        };
    }

    function isOverlapping(x, y, size) {
        // check against previously placed images
        for (const img of placedImages) {
            const dx = x - img.x;
            const dy = y - img.y;
            const distance = Math.sqrt(dx*dx + dy*dy);
            if (distance < (size/2 + img.size/2 + 20)) return true;
        }

        // check against main image
        const mainImg = document.getElementById('loveImage');
        if (mainImg) {
            const rect = getElementRect(mainImg);
            const dx = x - rect.x;
            const dy = y - rect.y;
            const distance = Math.sqrt(dx*dx + dy*dy);
            if (distance < (size/2 + rect.size/2 + 20)) return true;
        }

        // check against text messages
        const texts = document.querySelectorAll('.message, #loveText');
        texts.forEach(text => {
            const rect = getElementRect(text);
            const dx = x - rect.x;
            const dy = y - rect.y;
            const distance = Math.sqrt(dx*dx + dy*dy);
            if (distance < (size/2 + rect.size/2 + 20)) return true;
        });

        return false;
    }

    // Extra images that don't overlap
    const extraImages = ['love2.jpeg','love3.jpeg','love4.jpeg','love5.jpeg'];

    function spawnImage(src) {
        const img = document.createElement('img');
        img.src = src;
        img.className = 'floating-image';
        const maxAttempts = 50;
        let size = 150 + Math.random() * 150;
        let x, y;
        let attempts = 0;

        do {
            x = Math.random() * (window.innerWidth - size);
            y = Math.random() * (window.innerHeight - size);
            attempts++;
        } while (isOverlapping(x + size/2, y + size/2, size) && attempts < maxAttempts);

        img.style.width = `${size}px`;
        img.style.left = `${x}px`;
        img.style.top = `${y}px`;
        document.body.appendChild(img);
        setTimeout(() => img.style.opacity = '1', 200);

        placedImages.push({x: x + size/2, y: y + size/2, size});
    }

    // Spawn images with delay
    extraImages.forEach((src, i) => {
        setTimeout(() => {
            spawnImage(src);
        }, (15000 + Math.random() * 10000) * (i + 1));
    });
</script>
